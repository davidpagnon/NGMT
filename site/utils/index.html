
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../modules/">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.3">
    
    
      
        <title>Utilities - NeuroGeriatricsMotionToolbox NGMT</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.79e020e9.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#utils.preprocessing" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="NeuroGeriatricsMotionToolbox NGMT" class="md-header__button md-logo" aria-label="NeuroGeriatricsMotionToolbox NGMT" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NeuroGeriatricsMotionToolbox NGMT
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Utilities
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="NeuroGeriatricsMotionToolbox NGMT" class="md-nav__button md-logo" aria-label="NeuroGeriatricsMotionToolbox NGMT" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    NeuroGeriatricsMotionToolbox NGMT
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome to MkDocs
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../datasets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Datasets
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../modules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modules
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Utilities
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Utilities
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#utils.preprocessing" class="md-nav__link">
    preprocessing
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utils.preprocessing.calculate_envelope_activity" class="md-nav__link">
    calculate_envelope_activity()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utils.preprocessing.convert_pulse_train_to_array" class="md-nav__link">
    convert_pulse_train_to_array()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utils.preprocessing.find_consecutive_groups" class="md-nav__link">
    find_consecutive_groups()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utils.preprocessing.find_interval_intersection" class="md-nav__link">
    find_interval_intersection()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utils.preprocessing.find_local_min_max" class="md-nav__link">
    find_local_min_max()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utils.preprocessing.identify_pulse_trains" class="md-nav__link">
    identify_pulse_trains()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utils.preprocessing.organize_and_pack_results" class="md-nav__link">
    organize_and_pack_results()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utils.preprocessing.remove_40Hz_drift" class="md-nav__link">
    remove_40Hz_drift()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utils.preprocessing.resample_interpolate" class="md-nav__link">
    resample_interpolate()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#utils.preprocessing" class="md-nav__link">
    preprocessing
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utils.preprocessing.calculate_envelope_activity" class="md-nav__link">
    calculate_envelope_activity()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utils.preprocessing.convert_pulse_train_to_array" class="md-nav__link">
    convert_pulse_train_to_array()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utils.preprocessing.find_consecutive_groups" class="md-nav__link">
    find_consecutive_groups()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utils.preprocessing.find_interval_intersection" class="md-nav__link">
    find_interval_intersection()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utils.preprocessing.find_local_min_max" class="md-nav__link">
    find_local_min_max()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utils.preprocessing.identify_pulse_trains" class="md-nav__link">
    identify_pulse_trains()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utils.preprocessing.organize_and_pack_results" class="md-nav__link">
    organize_and_pack_results()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utils.preprocessing.remove_40Hz_drift" class="md-nav__link">
    remove_40Hz_drift()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utils.preprocessing.resample_interpolate" class="md-nav__link">
    resample_interpolate()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Utilities</h1>

<p>This part of the project documentation focuses on
the avaliable <strong>utilities</strong>.</p>


<div class="doc doc-object doc-module">



<a id="utils.preprocessing"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h2 id="utils.preprocessing.calculate_envelope_activity" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">calculate_envelope_activity</span><span class="p">(</span><span class="n">input_signal</span><span class="p">,</span> <span class="n">smooth_window</span><span class="p">,</span> <span class="n">threshold_style</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">plot_results</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p><em>summary</em>
Calculate envelope-based activity detection using the Hilbert transform.</p>
<p>This function analyzes an input signal <code>input_signal</code> to detect periods of activity based on the signal's envelope.
It calculates the analytical signal using the Hilbert transform, smoothes the envelope, and applies an
adaptive threshold to identify active regions.</p>
<p>Args:
input_signal (array_like): The input signal.
smooth_window (int): Window length for smoothing the envelope (default is 20).
threshold_style (int): Threshold selection style: 0 for manual, 1 for automatic (default is 1).
duration (int): Minimum duration of activity to be detected (default is 20).
plot_results (int): Set to 1 for plotting results, 0 otherwise (default is 1).</p>
      <p>tuple(ndarray, ndarray): A tuple containing:
    - alarm (ndarray): Vector indicating active parts of the signal.
    - env (ndarray): Smoothed envelope of the signal.</p>

          <details class="quote">
            <summary>Source code in <code>ngmt\utils\preprocessing.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">calculate_envelope_activity</span><span class="p">(</span>
    <span class="n">input_signal</span><span class="p">,</span> <span class="n">smooth_window</span><span class="p">,</span> <span class="n">threshold_style</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">plot_results</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;_summary_</span>
<span class="sd">    Calculate envelope-based activity detection using the Hilbert transform.</span>

<span class="sd">    This function analyzes an input signal `input_signal` to detect periods of activity based on the signal&#39;s envelope.</span>
<span class="sd">    It calculates the analytical signal using the Hilbert transform, smoothes the envelope, and applies an</span>
<span class="sd">    adaptive threshold to identify active regions.</span>

<span class="sd">    Args:</span>
<span class="sd">    input_signal (array_like): The input signal.</span>
<span class="sd">    smooth_window (int): Window length for smoothing the envelope (default is 20).</span>
<span class="sd">    threshold_style (int): Threshold selection style: 0 for manual, 1 for automatic (default is 1).</span>
<span class="sd">    duration (int): Minimum duration of activity to be detected (default is 20).</span>
<span class="sd">    plot_results (int): Set to 1 for plotting results, 0 otherwise (default is 1).</span>

<span class="sd">    Returns:</span>
<span class="sd">    tuple(ndarray, ndarray): A tuple containing:</span>
<span class="sd">        - alarm (ndarray): Vector indicating active parts of the signal.</span>
<span class="sd">        - env (ndarray): Smoothed envelope of the signal.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Input handling</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">locals</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>  <span class="c1"># If there is &lt; 5 inputs.</span>
        <span class="n">plot_results</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Default value</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">locals</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>  <span class="c1"># If there is &lt; 4 inputs.</span>
            <span class="n">duration</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c1"># Default value</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">locals</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>  <span class="c1"># If there is &lt; 3 inputs.</span>
                <span class="n">threshold_style</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Default 1, means it is done automatically</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">locals</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># If there is &lt; 2 inputs.</span>
                    <span class="n">smooth_window</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c1"># Default value for smoothing length</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">locals</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># If there is &lt; 1 inputs.</span>
                        <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span>
                            <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                                <span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">200</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
                            <span class="p">),</span>
                            <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                        <span class="p">)</span>  <span class="c1"># Generate true variance profile</span>
                        <span class="n">input_signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="o">*</span><span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

    <span class="c1"># Calculate the analytical signal and get the envelope</span>
    <span class="n">input_signal</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">input_signal</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="p">)</span>  <span class="c1"># Return a copy of the preprocessed data into one dimension.</span>
    <span class="c1"># Compute the analytic signal, using the Hilbert transform form scipy.signal.</span>
    <span class="n">analytic</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">hilbert</span><span class="p">(</span><span class="n">input_signal</span><span class="p">)</span>
    <span class="n">env</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">analytic</span><span class="p">)</span>  <span class="c1"># Compute the envelope of the analytic signal.</span>

    <span class="c1"># Take the moving average of the analytic signal</span>
    <span class="n">env</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span>
        <span class="n">env</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">smooth_window</span><span class="p">)</span> <span class="o">/</span> <span class="n">smooth_window</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;full&quot;</span>
    <span class="p">)</span>  <span class="c1"># Returns the discrete, linear convolution of two one-dimensional sequences.</span>
    <span class="n">env</span> <span class="o">=</span> <span class="n">env</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>  <span class="c1"># Remove the offset by subtracting the mean of &#39;env&#39;</span>
    <span class="n">env</span> <span class="o">=</span> <span class="n">env</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>  <span class="c1"># Normalize the &#39;env&#39; by dividing by its maximum value</span>

    <span class="c1"># Threshold the signal</span>
    <span class="k">if</span> <span class="n">threshold_style</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">hg</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Select a threshold on the graph&quot;</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">THR_SIG</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">ginput</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">hg</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">threshold_style</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">THR_SIG</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>

    <span class="c1"># Set noise and signal levels</span>
    <span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">env</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
        <span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span>
    <span class="p">)</span>  <span class="c1"># Noise level: Set an initial estimate of the noise level</span>
    <span class="n">threshold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span>
        <span class="n">env</span>
    <span class="p">)</span>  <span class="c1"># Signal level: It&#39;s used as a reference to distinguish between the background noise and the actual signal activity.</span>

    <span class="c1"># Initialize Buffers</span>
    <span class="n">thres_buf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">env</span><span class="p">)</span> <span class="o">-</span> <span class="n">duration</span>
    <span class="p">)</span>  <span class="c1"># This buffer stores values related to a threshold.</span>
    <span class="n">noise_buf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">env</span><span class="p">)</span> <span class="o">-</span> <span class="n">duration</span>
    <span class="p">)</span>  <span class="c1"># This buffer stores values related to the noise.</span>
    <span class="n">THR_buf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">env</span><span class="p">))</span>  <span class="c1"># This buffer stores threshold values.</span>
    <span class="n">alarm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>  <span class="c1"># This buffer tracks alarm-related information.</span>
    <span class="n">h</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">env</span><span class="p">)</span> <span class="o">-</span> <span class="n">duration</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">env</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="n">duration</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">THR_SIG</span><span class="p">):</span>
            <span class="n">alarm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span>
                <span class="n">env</span>
            <span class="p">)</span>  <span class="c1"># If the current window of data surpasses the threshold, set an alarm.</span>
            <span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span>
                <span class="n">env</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="n">duration</span><span class="p">]</span>
            <span class="p">)</span>  <span class="c1"># Set a new threshold based on the mean of the current window.</span>
            <span class="n">h</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Update noise</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">env</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="n">duration</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">THR_SIG</span><span class="p">:</span>
                <span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span>
                    <span class="n">env</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="n">duration</span><span class="p">]</span>
                <span class="p">)</span>  <span class="c1"># Update the noise value based on the mean of the current window.</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">noise_buf</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span>
                        <span class="n">noise_buf</span>
                    <span class="p">)</span>  <span class="c1"># If available, use the mean of noise buffer to update the noise.</span>
                    <span class="n">thres_buf</span><span class="p">[</span>
                        <span class="n">i</span>
                    <span class="p">]</span> <span class="o">=</span> <span class="n">threshold</span>  <span class="c1"># Store the threshold value in the threshold buffer.</span>
                    <span class="n">noise_buf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">noise</span>  <span class="c1"># Store the noise value in the noise buffer.</span>

            <span class="c1"># Update threshold</span>
            <span class="k">if</span> <span class="n">h</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">THR_SIG</span> <span class="o">=</span> <span class="n">noise</span> <span class="o">+</span> <span class="mf">0.50</span> <span class="o">*</span> <span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">threshold</span> <span class="o">-</span> <span class="n">noise</span><span class="p">)</span>
                <span class="p">)</span>  <span class="c1"># Update the threshold using noise and threshold values.</span>
                <span class="n">THR_buf</span><span class="p">[</span>
                    <span class="n">i</span>
                <span class="p">]</span> <span class="o">=</span> <span class="n">THR_SIG</span>  <span class="c1"># Store the updated threshold value in the threshold buffer.</span>

    <span class="k">if</span> <span class="n">plot_results</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">input_signal</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">alarm</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">input_signal</span><span class="p">),</span> <span class="mi">0</span><span class="p">),</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">THR_buf</span><span class="p">,</span> <span class="s2">&quot;--g&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Raw Signal and detected Onsets of activity&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
            <span class="p">[</span><span class="s2">&quot;Raw Signal&quot;</span><span class="p">,</span> <span class="s2">&quot;Detected Activity in Signal&quot;</span><span class="p">,</span> <span class="s2">&quot;Adaptive Threshold&quot;</span><span class="p">],</span>
            <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>

        <span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">THR_buf</span><span class="p">,</span> <span class="s2">&quot;--g&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">thres_buf</span><span class="p">,</span> <span class="s2">&quot;--r&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">noise_buf</span><span class="p">,</span> <span class="s2">&quot;--k&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Smoothed Envelope of the signal (Hilbert Transform)&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="s2">&quot;Smoothed Envelope of the signal (Hilbert Transform)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Adaptive Threshold&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Activity level&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Noise Level&quot;</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">alarm</span><span class="p">,</span> <span class="n">env</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="utils.preprocessing.convert_pulse_train_to_array" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">convert_pulse_train_to_array</span><span class="p">(</span><span class="n">pulse_train_list</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p><em>summary</em>
Convert a List of Pulse Train Dictionaries to a 2D Array.</p>
<p>This function takes a list of pulse train dictionaries and converts it into a 2D array.
Each dictionary is expected to have keys 'start' and 'end', and the function creates an array
where each row corresponds to a dictionary with the 'start' value in the first column and the
'end' value in the second column.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>pulse_train_list</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of dictionaries containing pulse train information.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>numpy.ndarray: A 2D array where each row represents a pulse train with the 'start' value
in the first column and the 'end' value in the second column.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>ngmt\utils\preprocessing.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">convert_pulse_train_to_array</span><span class="p">(</span><span class="n">pulse_train_list</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;_summary_</span>
<span class="sd">    Convert a List of Pulse Train Dictionaries to a 2D Array.</span>

<span class="sd">    This function takes a list of pulse train dictionaries and converts it into a 2D array.</span>
<span class="sd">    Each dictionary is expected to have keys &#39;start&#39; and &#39;end&#39;, and the function creates an array</span>
<span class="sd">    where each row corresponds to a dictionary with the &#39;start&#39; value in the first column and the</span>
<span class="sd">    &#39;end&#39; value in the second column.</span>

<span class="sd">    Args:</span>
<span class="sd">        pulse_train_list (list): A list of dictionaries containing pulse train information.</span>

<span class="sd">    Returns:</span>
<span class="sd">        numpy.ndarray: A 2D array where each row represents a pulse train with the &#39;start&#39; value</span>
<span class="sd">            in the first column and the &#39;end&#39; value in the second column.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">array_representation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">pulse_train_list</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint64</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">pulse_train_dict</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pulse_train_list</span><span class="p">):</span>
        <span class="n">array_representation</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">pulse_train_dict</span><span class="p">[</span>
            <span class="s2">&quot;start&quot;</span>
        <span class="p">]</span>  <span class="c1"># Access the &#39;start&#39; key within the dictionary</span>
        <span class="n">array_representation</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">pulse_train_dict</span><span class="p">[</span>
            <span class="s2">&quot;end&quot;</span>
        <span class="p">]</span>  <span class="c1"># Access the &#39;end&#39; key within the dictionary</span>

    <span class="k">return</span> <span class="n">array_representation</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="utils.preprocessing.find_consecutive_groups" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">find_consecutive_groups</span><span class="p">(</span><span class="n">input_array</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p><em>summary</em>
Find consecutive groups of non-zero values in an input array.</p>
<p>This function takes an input array <code>input_array</code>, converts it to a column vector, and identifies consecutive groups of
non-zero values. It returns a 2D array where each row represents a group, with the first column containing
the start index of the group and the second column containing the end index of the group.</p>
<p>Args:
input_array (ndarray): The input array.</p>
      <p>ind (ndarray): A 2D array where each row represents a group of consecutive non-zero values.
    The first column contains the start index of the group, and the second column contains the end index.</p>

          <details class="quote">
            <summary>Source code in <code>ngmt\utils\preprocessing.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">find_consecutive_groups</span><span class="p">(</span><span class="n">input_array</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;_summary_</span>
<span class="sd">    Find consecutive groups of non-zero values in an input array.</span>

<span class="sd">    This function takes an input array `input_array`, converts it to a column vector, and identifies consecutive groups of</span>
<span class="sd">    non-zero values. It returns a 2D array where each row represents a group, with the first column containing</span>
<span class="sd">    the start index of the group and the second column containing the end index of the group.</span>

<span class="sd">    Args:</span>
<span class="sd">    input_array (ndarray): The input array.</span>

<span class="sd">    Returns:</span>
<span class="sd">    ind (ndarray): A 2D array where each row represents a group of consecutive non-zero values.</span>
<span class="sd">        The first column contains the start index of the group, and the second column contains the end index.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">input_array</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># find indices of non-zeros</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)[</span>
        <span class="mi">0</span>
    <span class="p">]</span>  <span class="c1"># find where the difference between indices is greater than 1</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>  <span class="c1"># initialize the output array</span>
    <span class="n">ind</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)]</span>  <span class="c1"># set the second column</span>
    <span class="n">ind</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>  <span class="c1"># set the first column</span>

    <span class="k">return</span> <span class="n">ind</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="utils.preprocessing.find_interval_intersection" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">find_interval_intersection</span><span class="p">(</span><span class="n">set_a</span><span class="p">,</span> <span class="n">set_b</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p><em>summary</em>
Find the Intersection of Two Sets of Intervals.</p>
<p>Given two sets of intervals, this function computes their intersection and returns a new set
of intervals representing the overlapping regions.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>set_a</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The first set of intervals, where each row represents an interval with two values
indicating the start and end points.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>set_b</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The second set of intervals, with the same structure as <code>set_a</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>numpy.ndarray: A new set of intervals representing the intersection of intervals from <code>set_a</code> and <code>set_b</code>.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>ngmt\utils\preprocessing.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">find_interval_intersection</span><span class="p">(</span><span class="n">set_a</span><span class="p">,</span> <span class="n">set_b</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;_summary_</span>
<span class="sd">    Find the Intersection of Two Sets of Intervals.</span>

<span class="sd">    Given two sets of intervals, this function computes their intersection and returns a new set</span>
<span class="sd">    of intervals representing the overlapping regions.</span>

<span class="sd">    Args:</span>
<span class="sd">        set_a (numpy.ndarray): The first set of intervals, where each row represents an interval with two values</span>
<span class="sd">            indicating the start and end points.</span>
<span class="sd">        set_b (numpy.ndarray): The second set of intervals, with the same structure as `set_a`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        numpy.ndarray: A new set of intervals representing the intersection of intervals from `set_a` and `set_b`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">num_intervals_a</span> <span class="o">=</span> <span class="n">set_a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">num_intervals_b</span> <span class="o">=</span> <span class="n">set_b</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">intersection_intervals</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">num_intervals_a</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">num_intervals_b</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">intersection_intervals</span><span class="p">)</span>

    <span class="n">index_a</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">index_b</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">state</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="k">while</span> <span class="n">index_a</span> <span class="o">&lt;</span> <span class="n">num_intervals_a</span> <span class="ow">and</span> <span class="n">index_b</span> <span class="o">&lt;</span> <span class="n">num_intervals_b</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">state</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">set_a</span><span class="p">[</span><span class="n">index_a</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">set_b</span><span class="p">[</span><span class="n">index_b</span><span class="p">,</span> <span class="mi">0</span><span class="p">]:</span>
                <span class="n">index_a</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">state</span> <span class="o">=</span> <span class="mi">3</span>
            <span class="k">elif</span> <span class="n">set_a</span><span class="p">[</span><span class="n">index_a</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">set_b</span><span class="p">[</span><span class="n">index_b</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
                <span class="n">intersection_intervals</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">set_b</span><span class="p">[</span><span class="n">index_b</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">set_a</span><span class="p">[</span><span class="n">index_a</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
                <span class="n">index_a</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">state</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">intersection_intervals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">set_b</span><span class="p">[</span><span class="n">index_b</span><span class="p">,</span> <span class="p">:])</span>
                <span class="n">index_b</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">state</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">set_b</span><span class="p">[</span><span class="n">index_b</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">set_a</span><span class="p">[</span><span class="n">index_a</span><span class="p">,</span> <span class="mi">0</span><span class="p">]:</span>
                <span class="n">index_b</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">state</span> <span class="o">=</span> <span class="mi">3</span>
            <span class="k">elif</span> <span class="n">set_b</span><span class="p">[</span><span class="n">index_b</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">set_a</span><span class="p">[</span><span class="n">index_a</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
                <span class="n">intersection_intervals</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">set_a</span><span class="p">[</span><span class="n">index_a</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">set_b</span><span class="p">[</span><span class="n">index_b</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
                <span class="n">index_b</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">state</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">intersection_intervals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">set_a</span><span class="p">[</span><span class="n">index_a</span><span class="p">,</span> <span class="p">:])</span>
                <span class="n">index_a</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">state</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">set_a</span><span class="p">[</span><span class="n">index_a</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">set_b</span><span class="p">[</span><span class="n">index_b</span><span class="p">,</span> <span class="mi">0</span><span class="p">]:</span>
                <span class="n">state</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">state</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">intersection_intervals</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="utils.preprocessing.find_local_min_max" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">find_local_min_max</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p><em>summary</em>
Find Local Minima and Maxima in a Given Signal.</p>
<p>This function takes an input signal and identifies the indices of local minima and maxima.
Optionally, a threshold can be provided to filter out minima and maxima that do not exceed the threshold.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>signal</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The input signal.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>threshold</code></td>
          <td>
                <code>float or None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Threshold for filtering out minima and maxima below and above this value, respectively.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>tuple</code></td>          <td>
                <code>(<span title="numpy.ndarray">ndarray</span>, <span title="numpy.ndarray">ndarray</span>)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A tuple containing two arrays:
- minima_indices: Indices of local minima in the signal.
- maxima_indices: Indices of local maxima in the signal.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>ngmt\utils\preprocessing.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">find_local_min_max</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;_summary_</span>
<span class="sd">    Find Local Minima and Maxima in a Given Signal.</span>

<span class="sd">    This function takes an input signal and identifies the indices of local minima and maxima.</span>
<span class="sd">    Optionally, a threshold can be provided to filter out minima and maxima that do not exceed the threshold.</span>

<span class="sd">    Args:</span>
<span class="sd">        signal (numpy.ndarray): The input signal.</span>
<span class="sd">        threshold (float or None, optional): Threshold for filtering out minima and maxima below and above this value, respectively.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple(numpy.ndarray, numpy.ndarray): A tuple containing two arrays:</span>
<span class="sd">            - minima_indices: Indices of local minima in the signal.</span>
<span class="sd">            - maxima_indices: Indices of local maxima in the signal.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">signal_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span>
    <span class="n">zero_crossings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">signal_diff</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">*</span> <span class="n">signal_diff</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">zero_crossings</span> <span class="o">=</span> <span class="n">zero_crossings</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="n">minima_indices</span> <span class="o">=</span> <span class="n">zero_crossings</span><span class="p">[</span><span class="n">signal_diff</span><span class="p">[</span><span class="n">zero_crossings</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">maxima_indices</span> <span class="o">=</span> <span class="n">zero_crossings</span><span class="p">[</span><span class="n">signal_diff</span><span class="p">[</span><span class="n">zero_crossings</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">threshold</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">maxima_indices</span> <span class="o">=</span> <span class="n">maxima_indices</span><span class="p">[</span><span class="n">signal</span><span class="p">[</span><span class="n">maxima_indices</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">]</span>
        <span class="n">minima_indices</span> <span class="o">=</span> <span class="n">minima_indices</span><span class="p">[</span><span class="n">signal</span><span class="p">[</span><span class="n">minima_indices</span><span class="p">]</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">threshold</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">minima_indices</span><span class="p">,</span> <span class="n">maxima_indices</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="utils.preprocessing.identify_pulse_trains" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">identify_pulse_trains</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p><em>summary</em>
Identify Pulse Trains in a Given Signal.</p>
<p>This function takes an input signal and detects pulse trains within the signal.
A pulse train is identified as a sequence of values with small intervals between adjacent values.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>signal</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The input signal.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>list</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of dictionaries, each containing information about a detected pulse train.
Each dictionary has the following keys:
- 'start': The index of the first value in the pulse train.
- 'end': The index of the last value in the pulse train.
- 'steps': The number of steps in the pulse train.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>ngmt\utils\preprocessing.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">identify_pulse_trains</span><span class="p">(</span><span class="n">signal</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;_summary_</span>
<span class="sd">    Identify Pulse Trains in a Given Signal.</span>

<span class="sd">    This function takes an input signal and detects pulse trains within the signal.</span>
<span class="sd">    A pulse train is identified as a sequence of values with small intervals between adjacent values.</span>

<span class="sd">    Args:</span>
<span class="sd">        signal (numpy.ndarray): The input signal.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of dictionaries, each containing information about a detected pulse train.</span>
<span class="sd">            Each dictionary has the following keys:</span>
<span class="sd">            - &#39;start&#39;: The index of the first value in the pulse train.</span>
<span class="sd">            - &#39;end&#39;: The index of the last value in the pulse train.</span>
<span class="sd">            - &#39;steps&#39;: The number of steps in the pulse train.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pulse_trains</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">walking_flag</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">threshold</span> <span class="o">=</span> <span class="mf">3.5</span> <span class="o">*</span> <span class="mi">40</span>
    <span class="n">pulse_count</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">signal</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">signal</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">walking_flag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">pulse_trains</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="n">signal</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s2">&quot;steps&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
                    <span class="n">pulse_count</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">walking_flag</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">pulse_trains</span><span class="p">[</span><span class="n">pulse_count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="s2">&quot;steps&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">threshold</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="mf">1.5</span> <span class="o">*</span> <span class="mi">40</span>
                        <span class="o">+</span> <span class="p">(</span><span class="n">signal</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">pulse_trains</span><span class="p">[</span><span class="n">pulse_count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="s2">&quot;start&quot;</span><span class="p">])</span>
                        <span class="o">/</span> <span class="n">pulse_trains</span><span class="p">[</span><span class="n">pulse_count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="s2">&quot;steps&quot;</span><span class="p">]</span>
                    <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">walking_flag</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">pulse_trains</span><span class="p">[</span><span class="n">pulse_count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="s2">&quot;end&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="n">walking_flag</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">threshold</span> <span class="o">=</span> <span class="mf">3.5</span> <span class="o">*</span> <span class="mi">40</span>

    <span class="k">if</span> <span class="n">walking_flag</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">signal</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">signal</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">:</span>
            <span class="n">pulse_trains</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;end&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">pulse_trains</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;steps&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pulse_trains</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;end&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">pulse_trains</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="utils.preprocessing.organize_and_pack_results" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">organize_and_pack_results</span><span class="p">(</span><span class="n">walking_periods</span><span class="p">,</span> <span class="n">peak_steps</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Organize and Pack Walking Results with Associated Peak Steps.</p>
<p>Given lists of walking periods and peak step indices, this function organizes and packs the results
into a more structured format. It calculates the number of steps in each walking period, associates
peak steps with their corresponding walking periods, and extends the duration of walking periods based
on step time. The function also checks for overlapping walking periods and merges them.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>walking_periods</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of tuples representing walking periods, where each tuple contains the start and end indices.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>peak_steps</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of peak step indices.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>tuple</code></td>          <td>
                <code>(list, list)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A tuple containing two elements:
- A list of dictionaries representing organized walking results, each dictionary contains:
    - 'start': Start index of the walking period.
    - 'end': End index of the walking period.
    - 'steps': Number of steps within the walking period.
    - 'mid_swing': List of peak step indices within the walking period.
- A list of sorted peak step indices across all walking periods.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>ngmt\utils\preprocessing.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">organize_and_pack_results</span><span class="p">(</span><span class="n">walking_periods</span><span class="p">,</span> <span class="n">peak_steps</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Organize and Pack Walking Results with Associated Peak Steps.</span>

<span class="sd">    Given lists of walking periods and peak step indices, this function organizes and packs the results</span>
<span class="sd">    into a more structured format. It calculates the number of steps in each walking period, associates</span>
<span class="sd">    peak steps with their corresponding walking periods, and extends the duration of walking periods based</span>
<span class="sd">    on step time. The function also checks for overlapping walking periods and merges them.</span>

<span class="sd">    Args:</span>
<span class="sd">        walking_periods (list): List of tuples representing walking periods, where each tuple contains the start and end indices.</span>
<span class="sd">        peak_steps (list): List of peak step indices.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple(list, list): A tuple containing two elements:</span>
<span class="sd">            - A list of dictionaries representing organized walking results, each dictionary contains:</span>
<span class="sd">                - &#39;start&#39;: Start index of the walking period.</span>
<span class="sd">                - &#39;end&#39;: End index of the walking period.</span>
<span class="sd">                - &#39;steps&#39;: Number of steps within the walking period.</span>
<span class="sd">                - &#39;mid_swing&#39;: List of peak step indices within the walking period.</span>
<span class="sd">            - A list of sorted peak step indices across all walking periods.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">num_periods</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">walking_periods</span><span class="p">)</span>
    <span class="n">organized_results</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="n">walking_periods</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;end&quot;</span><span class="p">:</span> <span class="n">walking_periods</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
            <span class="s2">&quot;steps&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;mid_swing&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_periods</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="n">all_mid_swing</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_periods</span><span class="p">):</span>
        <span class="n">steps_within_period</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">p</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">peak_steps</span>
            <span class="k">if</span> <span class="n">organized_results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;start&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">p</span> <span class="o">&lt;=</span> <span class="n">organized_results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;end&quot;</span><span class="p">]</span>
        <span class="p">]</span>
        <span class="n">organized_results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;steps&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">steps_within_period</span><span class="p">)</span>
        <span class="n">organized_results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;mid_swing&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">steps_within_period</span>
        <span class="n">all_mid_swing</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">steps_within_period</span><span class="p">)</span>

        <span class="c1"># Calculate step time based on detected peak steps</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">steps_within_period</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">step_time</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">steps_within_period</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">steps_within_period</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">steps_within_period</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                <span class="p">]</span>
            <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">steps_within_period</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">organized_results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;start&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
                <span class="n">organized_results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;start&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">step_time</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="p">)</span>
            <span class="n">organized_results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;end&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
                <span class="n">organized_results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;end&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">step_time</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="p">)</span>

    <span class="n">all_mid_swing</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

    <span class="c1"># Check for overlapping walking periods and merge them</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">num_periods</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">organized_results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;end&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">organized_results</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="s2">&quot;start&quot;</span><span class="p">]:</span>
            <span class="n">organized_results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;end&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">organized_results</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="s2">&quot;end&quot;</span><span class="p">]</span>
            <span class="n">organized_results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;steps&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">organized_results</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="s2">&quot;steps&quot;</span><span class="p">]</span>
            <span class="n">organized_results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;mid_swing&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                <span class="n">organized_results</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="s2">&quot;mid_swing&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">organized_results</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">num_periods</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">organized_results</span><span class="p">,</span> <span class="n">all_mid_swing</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="utils.preprocessing.remove_40Hz_drift" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">remove_40Hz_drift</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p><em>summary</em>
Remove 40Hz drift from a signal using a high-pass filter.</p>
<p>This function applies a high-pass filter to remove low-frequency drift at 40Hz
from the input signal <code>signal</code>.</p>
<p>Args:
signal (array_like): The input signal.</p>
<p>Returns:
filtered_signal (ndarray): The filtered signal with removed drift.</p>

          <details class="quote">
            <summary>Source code in <code>ngmt\utils\preprocessing.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">remove_40Hz_drift</span><span class="p">(</span><span class="n">signal</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;_summary_</span>
<span class="sd">    Remove 40Hz drift from a signal using a high-pass filter.</span>

<span class="sd">    This function applies a high-pass filter to remove low-frequency drift at 40Hz</span>
<span class="sd">    from the input signal `signal`.</span>

<span class="sd">    Args:</span>
<span class="sd">    signal (array_like): The input signal.</span>

<span class="sd">    Returns:</span>
<span class="sd">    filtered_signal (ndarray): The filtered signal with removed drift.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">numerator_coefficient</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="p">)</span>  <span class="c1"># The numerator coefficient vector of the filter.</span>
    <span class="n">denominator_coefficient</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9748</span><span class="p">]</span>
    <span class="p">)</span>  <span class="c1"># The denominator coefficient vector of the filter.</span>
    <span class="n">filtered_signal</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">filtfilt</span><span class="p">(</span>
        <span class="n">numerator_coefficient</span><span class="p">,</span>
        <span class="n">denominator_coefficient</span><span class="p">,</span>
        <span class="n">signal</span><span class="p">,</span>
        <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">padtype</span><span class="o">=</span><span class="s2">&quot;odd&quot;</span><span class="p">,</span>
        <span class="n">padlen</span><span class="o">=</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">numerator_coefficient</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">denominator_coefficient</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">filtered_signal</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="utils.preprocessing.resample_interpolate" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">resample_interpolate</span><span class="p">(</span><span class="n">input_signal</span><span class="p">,</span> <span class="n">initial_sampling_rate</span><span class="p">,</span> <span class="n">target_sampling_rate</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p><em>summary</em>
Resample and interpolate a signal to a new sampling rate.</p>
<p>This function takes a signal <code>input_signal</code> sampled at an initial sampling rate <code>initial_sampling_rate</code>
and resamples it to a new sampling rate <code>target_sampling_rate</code> using linear interpolation.</p>
<p>Args:
input_signal (array_like): The input signal.
initial_sampling_rate (float): The initial sampling rate of the input signal.
target_sampling_rate (float): The desired sampling rate for the output signal.</p>
<p>Returns:
resampled_signal (array_like): The resampled and interpolated signal.</p>

          <details class="quote">
            <summary>Source code in <code>ngmt\utils\preprocessing.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">resample_interpolate</span><span class="p">(</span><span class="n">input_signal</span><span class="p">,</span> <span class="n">initial_sampling_rate</span><span class="p">,</span> <span class="n">target_sampling_rate</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;_summary_</span>
<span class="sd">    Resample and interpolate a signal to a new sampling rate.</span>

<span class="sd">    This function takes a signal `input_signal` sampled at an initial sampling rate `initial_sampling_rate`</span>
<span class="sd">    and resamples it to a new sampling rate `target_sampling_rate` using linear interpolation.</span>

<span class="sd">    Args:</span>
<span class="sd">    input_signal (array_like): The input signal.</span>
<span class="sd">    initial_sampling_rate (float): The initial sampling rate of the input signal.</span>
<span class="sd">    target_sampling_rate (float): The desired sampling rate for the output signal.</span>

<span class="sd">    Returns:</span>
<span class="sd">    resampled_signal (array_like): The resampled and interpolated signal.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">recording_time</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_signal</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">recording_time</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">xq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">recording_time</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">initial_sampling_rate</span> <span class="o">/</span> <span class="n">target_sampling_rate</span><span class="p">)</span>
    <span class="n">interpolator</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">input_signal</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span>
    <span class="p">)</span>  <span class="c1"># Create an interpolation function and apply it to the data</span>
    <span class="n">resampled_signal</span> <span class="o">=</span> <span class="n">interpolator</span><span class="p">(</span><span class="n">xq</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">resampled_signal</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.a264c092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.6eac0284.min.js"></script>
      
    
  </body>
</html>